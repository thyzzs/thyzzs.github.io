<!DOCTYPE HTML>
<html lang="en-uk">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="R for Data Science, 天何言哉">
    <meta name="description" content="系统介绍如何利用 R 语言及 tidyverse 生态系统解决实际数据问题。从数据导入、清洗（dplyr）、可视化（ggplot2）到建模（tidymodels）">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-CFBH42KL3R"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-CFBH42KL3R');
</script>


    <title>R for Data Science | 天何言哉</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="天何言哉" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">天何言哉</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">天何言哉</div>
        <div class="logo-desc">
            
            鸿蒙初辟本无性，打破顽冥须悟空
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">R for Data Science</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Statistics/">
                                <span class="chip bg-color">Statistics</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Course-Notes/" class="post-category">
                                Course Notes
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2025-08-05
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2025-08-13
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    8.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    39 Min
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="基本操作">基本操作</h2>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">system()
system.time() # 计算系统运算时间

getwd()
setwd("……")
q()
load()

head()
tail()

colors() # 显示657种所有颜色名称

rm()
rm(A)
rm(list = ls()) # 清理全部数据

A &lt;- 2
(A &lt;- 2) #赋值语句外加上括号会打印出赋值后变量的值

# 路径名称使用'/'或'\\', 而不是'\'
odbcConnectExcel('E:/b.xls') # 正确
odbcConnectExcel('E:\\b.xls') # 正确
odbcConnectExcel('E:\b.xls') # 错误<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 函数基本格式
hi.world &lt;- function() {
  cat("Hello World!\n")
}

hi.world()

# 函数读入和修改
source()
edit()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 包的安装
install.packages('')
# dependencies=TRUE (安装依赖包)
installed.packages()
rownames(installed.packages()) # 查看已经安装的包名
available.packages()

# 包的加载己搜索
search()
library()
require()

# 加载多个包
x &lt;- c("plyr", "psych", "tm")
lapply(x, require, character.only = TRUE)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 帮助
help(exp)
?exp

example(exp)
help.search("poisson")
??"poisson"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="数据结构">数据结构</h2>
<p>R是一种基于对象的语言。R的对象分为单纯对象和复合对象两种：<strong>单纯对象</strong>的所有元素都是同一数据类型（数值、字符串），元素不再是对象；<strong>复合对象</strong>的元素可是是不同的类型，每个元素是一个对象。</p>
<p>在统计学中，变量分为<strong>名义变量(nominal variable)或分类变量(categorical variable)</strong>，和<strong>数值变量(numerical variable)</strong>。<br>
在R中，变量类型可以归类为三种类型：名义型、有序型和连续型。<strong>名义型</strong>表示分类，并且类型之间没有顺序之分，如性别（男性和女性）；<strong>有序型</strong>也表示分类，不过类型之间存在顺序关系，而非数量关系，如近视程度（不近视、轻微近视、严重近视）；<strong>连续型</strong>呈现某个范围内的取值，同时存在顺序和数量上的区别，如年龄。<br>
<strong>其中，名义型变量和有序型变量在R中被称为<a href="#%E5%9B%A0%E5%AD%90">因子</a>。</strong></p>
<ul>
<li>
<p><strong>R语言中S3,S4,RC结构详见：</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/31486406">https://www.zhihu.com/question/31486406</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/HeYanjie/p/6292536.html">http://www.cnblogs.com/HeYanjie/p/6292536.html</a></li>
<li><a target="_blank" rel="noopener" href="https://uploads.cosx.org/2012/11/ChinaR2012_SH_Nov04_07_WYC.pdf">https://uploads.cosx.org/2012/11/ChinaR2012_SH_Nov04_07_WYC.pdf</a></li>
</ul>
</li>
<li>
<p><strong>其他参考资料：</strong></p>
<ul>
<li>R语言学习笔记(2)-数据类型和数据结构: <a target="_blank" rel="noopener" href="http://developer.51cto.com/art/201305/393125.htm">http://developer.51cto.com/art/201305/393125.htm</a></li>
<li>R语言进阶之4-数据整形(reshape)： <a target="_blank" rel="noopener" href="http://developer.51cto.com/art/201305/396615.htm">http://developer.51cto.com/art/201305/396615.htm</a></li>
<li>R语言中的vector(向量),array(数组)总结： <a target="_blank" rel="noopener" href="http://blog.csdn.net/yezonggang/article/details/51103460">http://blog.csdn.net/yezonggang/article/details/51103460</a></li>
</ul>
</li>
</ul>
<h3 id="模式和类型查看等">模式和类型查看等</h3>
<ol>
<li><strong>在R中，向量的下标从1开始计数（向量长度可以为0）；</strong></li>
<li><strong>typeof类型仅在numeric上有区别，默认为双精度，整型数据需要加“L”；</strong></li>
<li><strong>class()和attr()可以对数据类型进行操作，而且对原数据直接进行修改，而不是返回新的数据。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">class() # 类：numeric/character/logical/complex/list/data.frame
mode() # 模式属性：numeric/character/logical/complex/list/expression……
typeof() # 类型属性：double/integer/character/logical/complex/list/expression……，仅在numeric上有区别，默认为双精度，整型数据需要加“L”
length() # 长度属性
unclass() # 拆分数据

# class()还可以更改对象的类，直接对数据进行修改
x &lt;- 1:6
class(x) &lt;- "logical"
class(x) = "matrix" # 错误
# 通过函数attributes()和attr()进行操作
attr(x, "dim") = c(2, 3)

str() # 查看数据的内部结构
range() # 取数据范围

Inf # ∞
-Inf # -∞
NA # 缺失值
NULL # 空值
NaN # Not a Number（数据不确定）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">apply()  # 应用于矩阵、数据框或表（数据框和矩阵相似）
apply(m, dimcode, f, fargs) # 详见#矩阵-对行列调用函数
tapply() # 应用于原子型对象（向量）和因子
tapply(X, INDEX, F) # 详见#因子-因子调用函数
lapply() # 应用于列表或数据框（数据框为列表的特例），返回列表
sapply() # 应用于列表或数据框，可以返回列表、向量或矩阵
lapply(m, f) # 详见列表-列表调用函数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 类型转换函数(is./as.)
# is. 判断数据类型，返回TRUE或FALSE
is.na() # 是否缺失
is.nan() # 是否不确定
is.null() # 是否空
is.finite() # 是否有限
is.infinite() # 是否无限
is.numeric() # 是否数值型数据
is.character() # 是否字符型数据
is.logical() # 是否逻辑型数据
is.vector() # 是否向量数据
is.list() # 是否列表向量
is.factor() # 是否因子数据
is.matrix() # 是否矩阵数据
is.array() # 是否数组数据
is.data.frame() # 是否数据框数据

# as. 转换数据类型
as.numeric()
as.character()
as.logical()
as.vector()
as.list()
as.factor()
as.matrix()
as.data.frame()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">names() # 向量元素的命名/数据集的列标签
dimnames()
dimnames(US_data)[[2]] # 输出列标签 相当于names()
dimnames(US_data)[[1]] # 输出行标签<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">#数据整形
reshape() / stack() / unstack() # 数据框/列表的长、宽格式之间转换

reshape() # R base/stats的函数，参数较多且复杂
reshape(data, varying = NULL, v.names = NULL, timevar = "time",
        idvar = "id", ids = 1:NROW(data),
        times = seq_along(varying[[1]]),
        drop = NULL, direction, new.row.names = NULL,
        sep = ".",
        split = if (sep == "") {
          list(regexp = "[A-Za-z][0-9]", include = TRUE) }
        else {
          list(regexp = sep, include = FALSE, fixed = TRUE) }
)

x &lt;- data.frame(CK = c(1.1, 1.2, 1.1, 1.5), T1 = c(2.1, 2.2, 2.3, 2.1), T2 = c(2.5, 2.2, 2.3, 2.1))
xx &lt;- stack(x)
unstack(xx)

reshape / reshape2程序包
melt() # “溶解”数据，会根据数据类型）选择melt.data.frame, melt.array 或 melt.list函数进行实际操作
# 数组类型
datax &lt;- array(1:8, dim = c(2, 2, 2))
melt(datax)
melt(datax, varnames = LETTERS[24:26], value.name = "Val") # 修改列名

# 列表类型（元素值排列在前，名称在后，越是顶级的列表元素名称越靠后）
datax &lt;- list(agi = "AT1G10000", GO = c("GO:1010", "GO:2020"), KEGG = c("0100", "0200", "0300"))
melt(datax)
melt(list(at_0100 = datax))

# 数据框类型（相对复杂）
melt(data, id.vars, measure.vars, variable.name = "variable", ..., na.rm = FALSE, value.name = "value")
# id.vars是被当做维度的列变量；每个变量在结果中占一列；measure.vars是被当成观测值的列变量，它们的列变量名称和值分别组成variable 和 value两列，列变量名称用variable.name 和 value.name来指定。
aq &lt;- melt(airquality, var.ids = c("Ozone", "Month", "Day"), measure.vars = c(2:4), variable.name = "V.type", value.name = "value")

# var.ids可以写成id，measure.vars可以写成measure.id和即measure.vars这两个参数可以只指定其中一个，剩余的列被当成另外一个参数的值；如果两个都省略，数值型的列被看成观测值，其他的被当成id。
# 如果想省略参数或者去掉部分数据，参数名最好用id/measure，否则得到的结果很可能不是你要的结果
melt(airquality, var.ids = 1) # 返回非理想结果
melt(airquality, id = 1)

cast() # 还原数据及汇总
cast(aq, Ozone + Month + Day ~ V.type)
cast(aq, Month ~ V.type, fun.aggregate = mean, na.rm = TRUE)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="向量">向量</h3>
<ol>
<li><strong>在R中，无法随意添加或删除元素，需要给向量重新赋值，后面的矩阵运算遵循相同规则；</strong></li>
<li><strong>两个向量进行运算时，R会自动循环补齐，后面的矩阵运算遵循相同规则；</strong></li>
<li><strong>索引向量的语法规则为：向量1[向量2]，负数的下标表示要把相应的元素剔除。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">seq() # 简单规律
seq(1, 5, by = 0.5)
seq(10, 100, length = 10)

rep() # 复杂规律
rep(1:5, 2)
rep(1:4, each = 2, times = 3)
rep(1:4, each = 2, len = 4) #因为长度是4，所以仅取前4项

c() # 没有规则，很常用

assign() # 赋值函数
assign（"a", c(1, 2, 3, 4, 5,6, 7, 8, 9))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 无法随意添加或删除元素，需要给向量重新赋值
z &lt;- c(11, 13, 19, 23)
z &lt;- c(z[1:2], 17, z[3:4])

# 两个向量进行运算时，R会自动循环补齐
x &lt;- c(1, 2, 3)
y &lt;- c(4, 6, 8, 10, 12)
x + y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 索引向量的语法规则为：向量1[向量2]
x &lt;- c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6)
x[c(2, 4)]
x[3:5]
# 负数的下标表示要把相应的元素剔除
x[-1]
x[-2:-4]

# 结果返回为TRUE或者FALSE
any()
all()

# 向量中提取元素
a &lt;- c(-1, 1, -2, 4, -5, 9)
b &lt;- a[a &lt; 0] # 等同于a&lt;0;a[c(TRUE, FALSE, TRUE, FALSE, TRUE, FALSE)]
a[a &lt; 0] &lt;- 0

subset()
a[a &lt; 0]
subset(a, a &gt;= 0) # 区别体现subset()排除掉NA值
which() / which.min() / which.max() # 返回元素的位置
which(a &lt; 0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="因子">因子</h3>
<p>在R中，因子可以看成一个包含了更多信息的向量，是将一个向量的重新“编码”；不同值的分类被称为“水平”。</p>
<ol>
<li><strong>将向量转化成因子，默认转化为名义型变量，如果要有目的地转化为有序型变量，需要设置参数order和levels.</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">factor()
ssample &lt;- c("BJ", "SH", "CQ", "SH") # 字符型向量 默认转化成名义型变量
sf &lt;- factor(ssample)
nsample &lt;- c(2, 3, 3, 5) # 数值型变量 转化后因子水平按数值大小创建
nf &lt;- factor(nsample)
assessment &lt;- c("weak", "good", "limited", "fair")
assessment1 &lt;- factor(assessment, order = TRUE, levels = c("good", "fair", "limited", "weak")) # 有序型变量 参数order = T, 并设置参数levels

gl()
# 生成因子水平
-n # 为因子水平
-k # 表示重复次数
-length # 表示总观察值
#e.g.
A &lt;- gl(3, 6)

# 因子插入
# 创建时可插入任一水平
sample &lt;- c(12, 15, 7, 10)
fsample &lt;- factor(sample, levels = c(7, 10, 12, 15, 100))
# 插入数据
fsample[5] &lt;- 100 # 只能添加水平中含有的值
fsample[6] &lt;- 99 # 非法操作

length(fsample) # 返回数据的长度，而非因子的长度

# 因子调用函数
tapply(X, INDEX, F) # X为原子型对象，INDEX为因子或因子列表（如果不是用as.factor强制转换，长度与X等长，F为应用函数

# INDEX为因子
wt &lt;- c(46, 39, 35, 42, 43, 43)
group &lt;- c("A", "B", "C", "A", "B", "C")
tapply(wt, as.factor(group), mean)

# INDEX为因子列表
wt &lt;- c(46, 39, 35, 42, 43, 43, 42, 44, 36, 40, 39, 38)
diet &lt;- c("A", "B", "C", "A", "B", "C", "A", "B", "C", "A", "B", "C")
gender &lt;- c("M", "M", "M", "M", "M", "M", "F", "F", "F", "F", "F", "F")
tapply(wt, list(as.factor(diet), as.factor(gender)), mean) # 输出二维矩阵

by(X, INDEX, F) # tapply()函数的变种，X可以是数据框和矩阵
by(myopia, myopia$degree, function(frame) frame[, 2] + frame[, 3])

split(X, f) # 形成分组 X为待处理数据，f为因子或因子列表
split(wt, list(diet, gender))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="列表">列表</h3>
<p>列表是R的结构型数据中最为复杂的一种，是向量的泛化，也就是对一些对象的有序集合。</p>
<ol>
<li><strong>列表元素访问时，双方括号返回对应元素的取值，单方括号返回原列表的字列表；</strong></li>
<li><strong>列表为“递归型”向量，即列表的元素可以再分，而向量是“原子型”向量。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">list()
goods &lt;- list(name = "Cookie", price = 4.00, outdate = FALSE)
goods &lt;- list("Cookie", 4.00, FALSE) #采用数值为默认的标签名

# 使用vector()创建
temp &lt;- vector(mode = "list")
temp[["name"]] &lt;- "Cookie"

# 列表递归
a1 &lt;- list(name = "Cookie", price = 4.0, outdate = FALSE)
a2 &lt;- list(name = "Milk", price = 2.0, outdate = TRUE)
warehouse &lt;- list(a1, a2)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 访问元素：双方括号返回对应元素的取值，单方括号返回原列表的字列表
goods$name
goods[["name"]]
goods[[1]]

goods["name"]
goods[1]

goods[1:2]
goods[[1:2]] # 错误使用

# 增删元素
goods$producer &lt;- "A Company" #添加标签并初始化
goods[["material"]] &lt;- "flour"
goods[[6]] &lt;- 1
goods$material &lt;- NULL

# 拼接列表
c()
c(list(A = 1, c = "C"), list(new = "NEW"))

# 列表转化为向量
unlist()
ngoods &lt;- unlist(goods)
c(……, recursive=T)
c(goods, recursive=T)
#去除元素的名称
names(ngoods) &lt;- NULL # 等同于unname(ngoods)

# 列表调用函数
lapply()
temp &lt;- list(1:10, -2:-9)
lapply(temp, mean)# 返回列表
sapply()
sapply(temp, mean)# 返回向量
sapply(temp, mean, simplify=FALSE, USE.NAMES=FALSE) # 等同于lapply(temp, mean)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="矩阵-数组">矩阵/数组</h3>
<p>矩阵是一个二维数组，只是每个元素都拥有相同的模式（数值型、字符型或逻辑型），<strong>矩阵可通过函数matrix创建矩阵</strong>；数组与矩阵类似，但是维度可以大于2，<strong>数组可通过array函数创建</strong>。</p>
<ol>
<li><strong>在R中，矩阵的行列都是从1开始编号，矩阵是按列存储；</strong></li>
<li><strong>元素取值或赋值时，和matlab不同：逗号后不用加冒号，使用方括号而不是圆括号；</strong></li>
<li><strong>drop=FALSE防止矩阵筛选后降维，数据框同样适用。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">matrix()
m &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 3)
m &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, ncol = 4) # 系统会自动循环补齐
m &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2)

array()
array(1:24, c(2, 3, 4))
array(1:24, dim = c(2, 3, 4))

m[2,] # 元素取值，和matlab不同：逗号后不用加冒号,使用方括号而不是圆括号
m[1, 1] &lt;- 4 # 元素赋值
m &lt;- matrix(c(1, 2, 3, 4, 5, 6), nrow = 2, byrow = TRUE) # 设置byrow矩阵元素按行排列

# 矩阵的行列取名
record &lt;- matrix(c(98, 75, 86, 92, 78, 95), nrow = 2)
colnames(record) &lt;- c("Math", "Physics", "Chemistry")
rownames(record) &lt;- c("John", "Mary")
record["John", "Physics"]

# drop=FALSE防止矩阵筛选后降维
m[m[, 1] %% 2 == 1 &amp; m[, 2] %% 2 == 1 &amp; m[, 3] %% 2 == 1, drop = FALSE]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">rowSums()
colSums()

dim()
nrow()
ncol()

# 数学意义上的矩阵乘法
%*%

#矩阵行列的修改，不能随意增加或删减矩阵行列
rbind()
cbind()

#对行列调用函数
apply(m, dimcode, f, fargs) # dimcode=1，对每行应用函数，dimcode=2，对每列应用函数，fargs表示可选参数集
apply(m, 2, max)

f &lt;- function(x){ x/sum(x)}
y &lt;- apply(z, 1, f)
y &lt;- t(apply(z, 1, f)) # 转置结果保持与原矩阵结构相同

# 待调用函数需要多个参数
outlier_value &lt;- function(matrix_row, method_opt){
if(method_opt==1){ return(max(matrix_row))}
if(method_opt==0){ return(min(matrix_row))}
}
apply(m, 1, outlier_value, 1)
apply(m, 1, outlier_value, 0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="数据框">数据框</h3>
<p>数据框（和矩阵相似）有行列两个维度，“列”表示变量，“行”表示变量的观察记录。<br>
数据框的每列可以是不同的模式(mode)，更像是列表的扩展。每列相当于一个向量（列表），向量长度一致，如果不一致会按“循环补齐”原则补充完整。</p>
<ol>
<li><strong>在数据框进行行列添加时，rbind(),cbind(),transform()和within()会返回一个新的数据框，并不会对原数据框做任何更改，frame$newcolumm会对原数据直接进行修改。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">data.frame(……, stringAsFactors = T) # 默认情况下会将向量转化为因子
male &lt;- c(124, 88, 200)
female &lt;- c(108, 56, 221)
degree &lt;- c("low", "middle", "high")
myopia &lt;- data.frame(degree, male, female)
myopia &lt;- data.frame(c("low", "middle", "high"), c(124, 88, 200), c(108, 56, 221))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 列表形式访问元素
# 输出向量
myopia$degree
myopia[["degree"]]
myopia[[1]]
# 输出子数据框
myopia["degree"]
myopia[1]

# 矩阵形式访问元素
myopia[1,]
myopia[, 2]
myopia[3, 2]

# 提取子数据框
sub &lt;- myopia[2, 1:2] # 单取一行，返回类型仍为数据框
sub &lt;- myopia[2:3, 2] # 单取一列，返回类型为向量
sub &lt;- myopia[2:3, 2, drop = F] # 设置drop=F时,返回类型为数据框
sub &lt;- myopia[2]; sub &lt;- sub[2:3, 1] # 效果同上

myopia[c("male", "female")]
myopia[male &gt; 100,]

# 数据框添加/删除
names &lt;- c("Jack", "Steven")
ages &lt;- c(15, 16)
students &lt;- data.frame(names, ages, stringsAsFactors = F) # 防止字符串转化为因子，避免添加数据时和因子的水平冲突

rbind(students, list("Sariah", 15))
cbind(students, gender = c("M", "M")) # rbind()和cbind()会返回一个新的数据框

students$gender &lt;- c("M", "M") # 对原数据框做更改
students$gender &lt;- NULL # 同上

transform()
aq &lt;- transform(airquality, log.ozone = log(Ozone), Ozone = NULL, Wind = Wind^2) # 增加/删除/修改

within()
aq &lt;- within(airquality, {
  log.ozone &lt;- log(Ozone)
  squared.wind &lt;- Wind^2
  rm(Ozone, Wind)
})

# 数据框合并
merge()
merge(students, students2) # 输出共同列名的行，不共享列名的行被排除
merge(students, students3, by.x = "names", by.y = "na") # 将students数据框中的names列和students2数据框中的na列合并
merge(students, students3, by.y = "na", by.x = "names", all.x = T) # 默认情况下all.x、all.y和all为FALSE，如果设置为TRUE，则会包含所有元素，缺失值取为NA
merge(students, students3, by.y = "na", by.x = "names", all.y = T)
merge(students, students3, by.y = "na", by.x = "names", all = T)

# 数据框调用函数
apply(tt[, 2:3, drop = F], 2, mean)
lapply(students, sort)
sapply(students, sort)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="表">表</h3>
<p>表和矩阵或数据框十分相似，对表进行过复杂的操作都可以类比矩阵或数据框。</p>
<ol>
<li><strong>table()的原理是使用交叉分类因子创建列联表，记录每一个因子水平组合的频数；</strong></li>
<li><strong>使用apply()和addmargins()计算表中变量的边际值，需要注意表的维度。</strong></li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">table()
# 使用交叉分类因子创建列联表，记录每一个因子水平组合的频数
table(list(diet, gender))
# 多维表的创建
table(artery$Diabetes)
table(list(artery$Diabetes, artery$Hypertension))
table(D = artery$Diabetes, H = artery$Hypertension, S = artery$Ever_smoked)

# 表中变量的边际值，同时注意高维表的边际值计算
dh_tab &lt;- table(list(D = artery$Diabetes, H = artery$Hypertension))
# 使用apply()函数
apply(dh_tab, 1, sum)
apply(dh_tab, 2, sum)
# 使用addmargins()函数
addmargins(dhs_tab)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="数据输入-输出">数据输入/输出</h2>
<h3 id="数据输入">数据输入</h3>
<ol>
<li><strong>读取Excel数据的方法：</strong> <a target="_blank" rel="noopener" href="http://blog.csdn.net/cl1143015961/article/details/50035529">http://blog.csdn.net/cl1143015961/article/details/50035529</a></li>
<li>
<ul>
<li><strong>加载RODBC安装包如下如下问题：</strong><br>
[RODBC] ERROR: state IM002, code 0, message [Microsoft][ODBC 驱动程序管理器]</li>
<li><strong>加载rJava安装包如下如下问题：</strong><br>
loadNamespace()里算’rJava’时.onLoad失败了，详细内容：<br>
调用: fun(libname, pkgname)<br>
错误: JAVA_HOME cannot be determined from the Registry</li>
<li><strong>解决方法：使用R 32-bit系统</strong></li>
</ul>
</li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">attach() # 用于直接读取列表的变量
detach() # 解除

readline()
website.address &lt;- readline("Please input the website address:\n")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="读取表格">读取表格</h4>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 读取表格
read.table() / read.csv() / read.delim()
-header # default = F(table), T(csv,delim)
-sep # default = " "(table), ","(csv), "\t"(delim)
-as.is # default = F, 默认情况下将字符型转化成因子，=T保持原数据类型
-check.names # default = T, 默认情况下会对标题进行检查，将列名中含有的特殊符号（如%)转化为., =F保持原来列名
-row.names
-col.names
-na.string # default = NA, 赋给缺失数据的值

read.delim("clipboard") # 读取剪贴板数据

read.fwf # 逐行读入数据
-widths # 设置变量的宽度<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="读取网页">读取网页</h4>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 读取网页
readHTMLTable() #XML安装包<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="读取数据库和其他软件格式数据">读取数据库和其他软件格式数据</h4>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># RODBC安装包，ODBC为微软公司提供的多类数据库的接口（Access, SQL Sever, Excel等）
odbcConnectExcel() # Excel
odbcConnectExcel2007()
……

# 读取Excel数据
# RODBC安装包
odbcConnectExcel() # .xls
odbcConnectExcel2007() # .xlsx
-sqlTables() # 给出ODBC连接对应的数据库中的数据表
-sqlFetch()  # 读取ODBC连接中的一个表到R的数据框中
-sqlQuery()# 在ODBC连接上执行查询语句并返回结果
-sqlCopy()   #
-sqlDrop()   #
-sqlClear()  #
……

channel = odbcConnectExcel2007("c:/car.xlsx")
sqlTables(channel)
sqlFetch(channel, "Sheet1")
data_excel2 = sqlQuery(channel, "select * from[Sheet1$]")
close(channel) # 等同于odbcClose(channel)

# xlsx安装包（需要依赖于rJava包）
read.xlsx()
read.xlsx2()
-sheetIndex # sheet索引号
……

table_test &lt;- read.xlsx("D:/R/xlsx.xlsx", 1)

# openxlsx安装包（不能读取.xls文件）
read.xlsx()
write.xlsx()
-sheetIndex # sheet索引号
……

table_test &lt;- read.xlsx("D:/R/xlsx.xlsx", 1)

# gdata包（电脑需要安装Perl）
read.xls()

# readxl包
read_excel()

# 处理数据库数据
略<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="数据输出">数据输出</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">cat()
car = file("d:/car.txt")
cat("Make lp100km mass.kg List.price", "\"Alpha Romeo\" 9.5 1242 38500", "\"Audi A3\" 8.8 1160 38700", file = car, sep = "\n")
close(car)

write.table() / write.csv()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="缺失值处理">缺失值处理</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 判断数据是否缺失
is.na()
air_data = airquality[1:7, 1:4]
is.na(air_data)
sum(is.na(air_data))

complete.cases() # 取值与is.na()相反
complete.cases(air_data) # 判定的是矩阵每一行是否完整
complete.cases(air_data$Ozone) # 判定的是单独某列是否完整

aggr() #缺失数据可视化（VIM程序包）
library(VIM)
air_data = airquality[1:31, 1:4]
aggr(air_data, las = 1, numbers = TRUE)

# 缺失样本删除
air_data[complete.cases(air_data),]
air_data[(!is.na(air_data$Ozone)) &amp; (!is.na(air_data$Solar.R)),]
no.omit()
na.omit(air_data)

# 缺失值替换
air_data2 = air_data
air_data2$Ozone[is.na(air_data2$Ozone)] = median(air_data$Ozone[!is.na(air_data$Ozone)])
air_data2$Solar.R[is.na(air_data2$Solar.R)] = round(mean(air_data$Solar.R[!is.na(air_data$Solar.R)]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="统计图形绘制">统计图形绘制</h2>
<p><strong>参考资料：</strong></p>
<ul>
<li>R绘图基础（一）：<a target="_blank" rel="noopener" href="http://bbs.pinggu.org/thread-3162571-1-1.html">http://bbs.pinggu.org/thread-3162571-1-1.html</a></li>
<li>第八讲R语言-图形函数： <a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/6236eb0e7cd184254b353524.html">https://wenku.baidu.com/view/6236eb0e7cd184254b353524.html</a></li>
<li>R语言绘图渐进：<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_5de124240101q5vw.html">http://blog.sina.com.cn/s/blog_5de124240101q5vw.html</a></li>
</ul>
<h3 id="绘图基础">绘图基础</h3>
<h4 id="绘制设备-Device">绘制设备(Device)</h4>
<p>R语言中的绘图设备有多种，但可以分为两类，一类是绘图文件，另一类是绘图窗口。另外，R绘图的工作方式与变量、数据和函数等对象的处理形式大为不同，绘图结果不能复制给一个对象，而是直接输出到绘图设备中。</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">windows() / dev.new(…) / win.graph() / X11() # 打开一个新的图形设备
png()/jpeg()/pdf()/bmp()/tiff()/postscript() # 打开一种绘图文件类型
dev.list() # 显示当前打开的所有图形设备编号
dev.cur()# 显示当前活动的图形设备
dev.set(…)# 切换活动图形设备号
dev.off()# 关闭指定设备号
graphics.off() # 关闭所有绘图窗口和图形设备<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="布局">布局</h4>
<p>R绘图所占的区域，被分成两大部分，一是外围边距，一是绘图区域。</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">par() # 图形参数永久设置，par()（括号中不写任何参数）返回当前的图形参数设置(list)

# 外围边距及布局  ！仅par()设置
-oma # 外围边距，oma(out margin area)，行高(line)为单位
-mfrow # mfrow = c(nr,nc), nr*nc矩阵布局，按行次使用窗口
-mcol # mcol = c(nr,nc), nr*nc矩阵布局，按列次使用窗口

split.screen() # 图形分割（可不规则划分），mfrow,mfcol可进行矩阵布局
close.screen(all = TRUE) # 退出
erase.screen() #
screen() # 预备输出

layout()
-widths
-heights
……
layout(matrix(c(1, 1, 2, 3), 2, 2, byrow = TRUE))# 布局第一排有一个图，第二排有两个图
layout(matrix(c(1, 2, 3, 3), 2, 2, byrow = TRUE))# 布局第一排有二个图，第二排有一个图
layout.show() # 显示具体的布局
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 绘制参数之绘图区域（绘图边距）！仅par()设置
-mar # 图形边空的四个向量 c(bottom, left, top, right)，default: par(mar=c(5, 4, 4, 2) + 0.1)，行高(line)为单位
-mai # 同上，inch为单位<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 可视化显示设置内容（R中运行如下脚本）
SOUTH&lt;-1; WEST&lt;-2; NORTH&lt;-3; EAST&lt;-4;

GenericFigure &lt;- function(ID, size1, size2)
{
  plot(0:10, 0:10, type="n", xlab="X", ylab="Y")
  text(5,5, ID, col="red", cex=size1)
  box("plot", col="red")
  mtext(paste("cex", size2, sep=""), SOUTH, line=3, adj=1.0, cex=size2, col="blue")
  title(paste("title", ID, sep=""))
}

MultipleFigures &lt;- function()
{
  GenericFigure("1", 3, 0.5)
  box("figure", lty="dotted", col="blue")

  GenericFigure("2", 3, 1)
  box("figure", lty="dotted", col="blue")

  GenericFigure("3", 3, 1.5)
  box("figure", lty="dotted", col="blue")

  GenericFigure("4", 3, 2)
  box("figure", lty="dotted", col="blue")
}

par(mfrow=c(2,2),mar=c(6,4,2,1),oma=c(4,3,2,1))

MultipleFigures()

box("inner", lty="dotted", col="green")
box("outer", lty="solid", col="green")

mtext("Outer Margin Area (oma) of South", SOUTH, line=1, cex=1, outer=TRUE)

plotline&lt;-function(n,direc){
  for(i in 0:n){
    mtext(paste("line", i, sep=""), direc, line=i, cex=1, col="black", adj=1, outer=TRUE)
  }
}
plotline(4,SOUTH)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 绘制参数之绘图区域（主绘图）
-fig # 任意未知作图（左下角(0,0),右上角(1,1)）
-new # 是否在原画布基础上作图

-bg # 背景色
-bty # 图形边框形状, 'n'(不绘制表框)
-pty # 's'正方形，'m'最大利用 ！par()设置

-adj # 字符位置：0(left), 0.5(center,default), 1(right)
-tck # 轴上刻度长度值（百分比），tck=1,绘制grid  ！仅暂时性设置
-tcl # 轴上刻度长度值（行高），tcl=0.5(default)
-cex # 缺省状态下符号和文字大小的值
-col # 符号颜色（边框）
-font # 文字字体，1(normal), 2(italic), 3(bold), 4(italic&amp;bord)
-cex.axis / col.axis / font.axis # 坐标轴刻度数字大小/颜色/字体
- * .lab  # 坐标轴标签文字大小/颜色/字体
- * .main # 坐标轴标题文字大小/颜色/字体
- * .sub  # 坐标轴副标题文字大小/颜色/字体
-ps # 控制整体文字的大小  ！par()设置
-las # 坐标轴刻度数字标记方向的整数， 0(平行于轴), 1(横排), 2(垂直于轴), 3(竖排)

-type # 'p'(绘制单独点default),'l'(线),'b'(both),’c'(点线图去掉点),'o'(点绘在线上),'h'(从点到零轴的垂线(high-density)),'s'/'S'(阶梯式图),'n'(不绘制,坐标轴是绘出)
-lty # 线型 (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash)
-pch # points符号类型，1-25,21-25可以加颜色，或者使用字符
-lwd # 宽度

-log # 坐标对数化
-axes = FALSE # 无坐标轴
-xaxt = "n" # 抑制X轴原标记及文字表达，与axis(side=1, ……)联用
-yaxt = "n" # 抑制Y轴原标记及文字表达，与axis(side=2, ……)联用
……

plot()# 创建一幅新的图形
-asp #y/x 坐标轴比例
……
curve(expr, from =, to =, ……)# 绘制函数对应的曲线
image()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 低级图形函数（向已经存在的图形中添加自己定义的信息）

points()
lines() # 在现有的图形上叠加一条密度曲线
abline(a, b) # 绘制斜率为a截距为b的直线
abline(h = y) # 水平线
abline(v = x) # 垂直线
rect(x1, y1, x2, y2) # 绘制长方形
rug() # 在现有的图形上叠加轴须图
box() # 为图形增加一个框
segments(x0, y0, x1, y1) # 两点间加线段
arrows(x0, y0, x1, y1, angle, code) # 同上，带箭头

text(x, y, labels) # 向指定点添加标记(labels)
mtext(text, side, line,) # 边空添加文字，line指定添加文字距离绘图区域的行数
axis() # 坐标表达设置
-side # 1=below, 2=left, 3=above and 4=right
-at
title() # 标题
legend() # 图例
polygon() # 曲线内填充颜色函数
-border # 边界颜色 F/NA为省略边界色，T/NULL为前景色

locator() # 交互<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="图像读取及处理">图像读取及处理</h3>
<p><strong>参考资料：</strong></p>
<ul>
<li>R语言图像处理： <a target="_blank" rel="noopener" href="http://blog.csdn.net/pyramidnail/article/details/8627880">http://blog.csdn.net/pyramidnail/article/details/8627880</a></li>
</ul>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">library(jpeg)
library(ggplot2)
library(reshape)

# 读取
readImage &lt;- readJPEG('test.jpg') # 读取图片，readJPEG为jpeg程序包下的函数
longImage &lt;- melt(readImage) # melt为reshape程序包下的函数
rgbImage &lt;- reshape(longImage, timevar = 'X3', idvar = c('X1', 'X2'), direction = 'wide')
colorColumns &lt;- rgbImage[, substr(colnames(rgbImage), 1, 5) == "value"] # 提取像素RGB值，substr(x, start, stop):Extract or replace substrings in a character vector.
rgbImage$X1 &lt;- -rgbImage$X1
with(rgbImage, plot(X2, X1, col = rgb(colorColumns), asp = 1, pch = ".", axes = F, xlab = '', ylab = ''))
# 上述三条语句可简化为：
plot(rgbImage$X2, -rgbImage$X1, col = rgb(rgbImage[3:5]), asp = 1, pch = ".", axes = F, xlab = '', ylab = '')

# 图像模糊处理
rgbAlter &lt;- rgbImage
rgbAlter$X2 &lt;- jitter(rgbAlter$X2)
rgbAlter$X1 &lt;- jitter(rgbAlter$X1)
rgbAlter$Size &lt;- runif(1:nrow(rgbAlter), 0, 2) # and random point sizes
with(rgbAlter, plot(X2, X1, col = rgb(colorColumns), asp = 1, cex = Size, axes = F, xlab = '', ylab = ''))

# 去除绿色
rgbAlter &lt;- rgbImage
rgbAlter[, 4] &lt;- 0
with(rgbAlter, plot(X2, X1, col = rgb(rgbAlter[, 3:5]), asp = 1, pch = ".", axes = F, xlab = '', ylab = ''))

# 曝光处理
rgbAlter &lt;- rgbImage
rgbAlter[, c(3:5)] &lt;- round(rgbAlter[, c(3:5)] * 2) / 2
with(rgbAlter, plot(X2, X1, col = rgb(rgbAlter[, 3:5]), asp = 1, pch = ".", axes = F, xlab = '', ylab = ''))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="饼状图">饼状图</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 二维饼状图
pie()
-main # 标题
-labels
-clockwise # T为顺时针，F为逆时针
-col # 颜色
-border # 边界颜色 F/NA为省略边界色，T/NULL为前景色 ###

countries &lt;- c("Brazil", "Russia", "India", "China", "South Africa")
GDP &lt;- c(23920, 20790, 18618, 94906, 3660)
percentage &lt;- round(GDP / sum(GDP) * 100, 2)
index &lt;- paste(countries, " ", percentage, "%", sep = "")
pie(GDP, labels = index, clockwise = T, col = rainbow(length(index)), main = "Pie Chart with Percentages")
legend('topright', countries, cex = 0.8, fill = rainbow(length(index)))

# 三维饼状图
pie3D() # plotreix程序包
-explode # 扇片间距

pie3D(GDP, labels = countries, explode = 0.1, main = "3D Pie Chart")

# 扇形图
fan.plot()
fan.plot(GDP, labels = countries, main = "Fan Plot")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="直方图">直方图</h3>
<p>直方图是一种对数据分布情况进行展示的二维统计图形，横轴将值域划分划分一定数量的组别，纵轴上则显示相应值出现的频数，<strong>与条形图不同</strong>。</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">hist()
-breaks # 划分档次，控制分组数量（调用pretty函数进行分组划分）
-xlab / ylab
-xlim / ylim
-freq # 设置为F，根据概率密度而不是频数绘制图形，实现直方图归一化
……

hist(mpg, breaks = 12, xlim = c(10, 35), xlab = "Miles/Gallon", main = "Histogram Example")
hist(mpg, breaks = c(2*5:9, 5*4:7), col = "blue1", ylim = c(0, 0.12), xlab = "Miles/Gallon", main = "Example with Non-equidistant Breaks") # 不等距划分，且直方图归一化
hist(mpg, breaks = 12, col = "blue1", ylim = c(0, 0.12), xlim = c(10, 35), freq = FALSE, xlab = "Miles/Gallon", main = "Histogram Example of Density ")

h &lt;- hist(mpg, breaks = 12, col = "blue", xlim = c(10, 35), xlab = "Miles/Gallon", main = "Histogram Example with Normal Curve")
xfit &lt;- seq(min(mpg), max(mpg), length = length(mpg))# 曲线是根据原始数据的均值和标准差估算出来的正态分布曲线所画
yfit &lt;- dnorm(xfit, mean=mean(mpg), sd=sd(mpg))
yfit &lt;- yfit*diff(h$mids[1:2])*length(mpg)# diff(h$mids[1:2])求间隙大小，diff求相邻两项的差
lines(xfit, yfit, col = "red", lwd = 2)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="核密图">核密图</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">density(); plot()

d &lt;- density(mpg)
plot(d, main = "Density of Miles/Gallon")
polygon(d, col = "wheat", border = "blue")
rug(jitter(mpg, amount = 0.01), col = "brown") # jitter()添加小的随机数

# 组间差异
plot(density(mtcars[mtcars$cyl == 4,]$mpg), col = "red", lty = 1, xlim = c(5, 40), ylim = c(0, 0.25), xlab = "", main = "")
par(new = TRUE) ###
plot(density(mtcars[mtcars$cyl == 6,]$mpg), col = "blue", lty = 2, xlim = c(5, 40), ylim = c(0, 0.25), xlab = "", main = "")
par(new = TRUE)
plot(density(mtcars[mtcars$cyl == 8,]$mpg), col = "green", lty = 3, xlim = c(5, 40), ylim = c(0, 0.25), xlab = "Miles/Gallon", main = "MPG Distribution by Cylinders")
text.legend = c("cyl=4", "cyl=6", "cyl=8")
legend("topright", legend = text.legend, lty = c(1, 2, 3), col = c("red", "blue", "green"))

# 组间差异（满足某种分布）
curve(dnorm(x, mean(mtcars[mtcars$cyl == 4,]$mpg), sd(mtcars[mtcars$cyl == 4,]$mpg)), from = 5, to = 40, ylim = c(0, 0.28), col = "red", lty = 1, xlab = "", ylab = "", main = "")
par(new = TRUE)
curve(dnorm(x, mean(mtcars[mtcars$cyl == 6,]$mpg), sd(mtcars[mtcars$cyl == 6,]$mpg)), from = 5, to = 40, ylim = c(0, 0.28), col = "blue", lty = 2, xlab = "", ylab = "", main = "")
par(new = TRUE)
curve(dnorm(x, mean(mtcars[mtcars$cyl == 8,]$mpg), sd(mtcars[mtcars$cyl == 8,]$mpg)), from = 5, to = 40, ylim = c(0, 0.28), col = "green", lty = 3, xlab = "Miles/Gallon", ylab = "Density", main = "MPG Distribution by Cylinders")
text.legend = c("cyl=4", "cyl=6", "cyl=8")
legend("topright", legend = text.legend, lty = c(1, 2, 3), col = c("red", "blue", "green"))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="箱线图">箱线图</h3>
<p>箱线图通过绘制一组数据的“<strong>最大值、最小值、中位数、下四分位数及上四分位数</strong>”这五个指标来显示该组数据的分散情况。</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">boxplot()
boxplot(mpg, main = "Box plot", ylab = "Miles per Gallon")

boxplot.stats(x, coef = 1.5, do.conf = TRUE, do.out = TRUE) # 仅输出统计结果，不画图
-coef # default = 1.5 "须"长度的极限值，1.5倍四分位距；设置为0，上升至数据集的极限（最大值最小值）
# 输出结果参数
-stats # 盒须最小值 盒最小值 中位数 盒最大值 盒须最大值
-n # 非缺失值的个数
-conf # 中位数95%的置信区间
-out # 异常值

# 返回五个指标的函数
fivenum &lt;- function(x) {
  x &lt;- sort(x)
  n &lt;- length(x)
  n4 &lt;- floor((n + 3) / 2) / 2
  d &lt;- c(1, n4, (n + 1) / 2, n + 1 - n4, n)
  return(0.5 * (x[floor(d)] + x[ceiling(d)]))
}

summary()
quantile()


# 并列箱线图
boxplot(mpg ~ cyl, data = mtcars, main = " ", xlab = " ", ylab = " ")

# 凹槽箱线图
boxplot(mpg ~ cyl, data = mtcars, notch = TRUE, main = " ", ylab = " ", xaxt = "n") # xaxt = "n" 抑制X轴原表达
axis(side = 1, at = c(1, 2, 3), labels = c("4 cylinders", "6 cylinders", "8 cylinders"))

# 多个分组因子箱线图
cyl.f &lt;- factor(cyl, levels = c(4, 6, 8), labels = c("4 cyls", "6 cyls", "8 cyls"))
am.f &lt;- factor(am, levels = c(0, 1), labels = c("auto", "std"))
boxplot(mpg ~ am.f * cyl.f, data = mtcars, varwidth = TRUE, col = c("wheat", "orange"), xlab = " ", main = " ")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="条形图">条形图</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">barplot()
-height # 要求为矩阵或者向量
-names.arg # 添加条形名称

# Vertical
my.data &lt;- c(5.87, 7.94, 3.77, 7.41, 5.37)
names(my.data) &lt;- c("US", "Japan", "China", "Brazil", "India") # 可用barplot()
函数中names.arg参数替换
barplot(my.data, ylim = c(0, round(max(my.data))), main = "Barplot Example (Vertical)", xlab = "Countries", ylab = "GDP per Energy")

# Horizontal(,horiz = TRUE)
barplot(my.data, xlim = c(0, round(max(my.data))), horiz = TRUE, main = "Barplot Example (Horizontal)", xlab = "GDP per Energy", ylab = "Countries")

# 堆砌
my.data &lt;- matrix(c(38.1, 1.7, 27.8, 28.7, 34.1, 69.6), nrow = 2)
rownames(my.data) &lt;- c("China", "Germany")
colnames(my.data) &lt;- c("primary", "secondary", "tertiary")
barplot(my.data, main = "Grouped Barplot", col = c("wheat", "orange"), legend = rownames(my.data), args.legend = list(x = "top"))

# 并列(beside = TRUE)
barplot(my.data, main = "Grouped Barplot", col = c("wheat", "orange"), beside = TRUE, legend = rownames(my.data), args.legend = list(x = "top"))

# 棘状图
library(vcd)
spine(my.data, main = "Employment in Three Industries")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="qq图">qq图</h3>
<p>分位数函数就是相应累积分布函数的反函数，<br>
QQ图(Quantile-Quantile Plot)用于直观验证一组数据是否来自于某个分布。</p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 累积分布函数及分位数函数(其反函数)
x &lt;- seq(-3, 3, by = 0.1)
cdf &lt;- pnorm(x, 0, 1)
plot(cdf ~ x, ylim = c(-3, 3), type = "l", lty = 2, xlab = "", ylab = "")
par(new = TRUE)
plot(qnorm(cdf) ~ cdf, xlim = c(-3, 3), type = "l")

qqnorm() / qqline() / qqplot()

dset = c(83.83, 95.30, 100.67, 105.01, 108.70, 110.28, 117.14, 125.39, 127.91, 142.24)
q.dset &lt;- seq(0.05, 0.95, by = 0.1)
q.norm &lt;- qnorm(q.dset)
round(q.norm, 2) # 区小数点后两位

plot(dset ~ q.norm, main = "Normal Q-Q Plot (Manually)", col = "red")
par(new = TRUE)
qqline(dset)
qqnorm(dset, main = "Normal Q-Q Plot (By R)", col = "blue")
qqline(dset)

# 验证中央极限定理
exponential.pop &lt;- rexp(1000, rate = 1)
exp.means &lt;- sapply(1:1000, function(x) mean(sample(exponential.pop, size = 15)))
my.data &lt;- exp.means[1:50]
qqnorm(my.data)
qqline(my.data)

# 验证两组数据是否来自同一分布
exp.pop &lt;- rexp(100, rate = 1)
qqplot(exp.pop, rexp(100, rate = 1))
qqplot(exp.pop, rexp(50, rate = 1)) # 两组数据元素不一致，元素个数少的那组数据通过插值方法补齐<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="等高线图及三维图">等高线图及三维图</h3>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 等高线图
contour() / filled.contour / image()

x &lt;- 10 * (1:nrow(volcano))
x.at &lt;- seq(100, 800, by = 100)
y &lt;- 10 * (1:ncol(volcano))
y.at &lt;- seq(100, 600, by = 100)

image(x, y, volcano, col = heat.colors(100), axes = FALSE)
# filled.contour(x, y, volcano, col=heat.colors(30),axes=FALSE) # 同时，并绘制图例

contour(x, y, volcano, levels = seq(90, 200, by = 5), add = TRUE, col = "brown")  # add=TRUE表示在image()基础上增加等高线
# contour(x, y, volcano, axes=FALSE) # 单独绘制出等高线

axis(1, at = x.at)
axis(2, at = y.at)
box()
title(main = "Maunga Whau Volcano", sub = "col=heat.colors(100)", font.main = 4)

# 三维图
persp()

persp(x, y, volcano, col = heat.colors(30), theta = 45, phi = 15, r = sqrt(3), d = 1, axes = FALSE)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="其他">其他</h3>
<h4 id="花瓣点图-sunflowerplot">花瓣点图(sunflowerplot())</h4>
<h4 id="interaction-plot-f1-f2-y">interaction.plot(f1, f2, y)</h4>
<h4 id="matplot">matplot()</h4>
<h4 id="pairs">pairs()</h4>
<h4 id="coplot">coplot()</h4>
<pre class="line-numbers language-R" data-language="R"><code class="language-R"># 关于z的每个数值（数值区间）绘制x与y的二元图
coplot(lat ~ long | depth, data = quakes)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="点图-striptchart">点图/striptchart()</h4>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">dotchart()
 # 数据
   cars trucks suvs
 1    1      2    4
 2    3      5    4
 3    6      4    6
 4    4      5    6
 5    9     12   16
dotchart(t(autos_data), color=c("red","blue","darkgreen"), main="Dotchart for Autos", cex=0.8)

striptchart() # x的值画在同一条直线上<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="重要函数">重要函数</h2>
<h3 id="报错警告">报错警告</h3>
<h4 id="try">try()</h4>
<p>在R中编程，可以使用try()函数捕捉错误。</p>
<p><strong>参考资料：</strong> <a target="_blank" rel="noopener" href="http://blog.csdn.net/fanfanrenrenmi/article/details/52142395">http://blog.csdn.net/fanfanrenrenmi/article/details/52142395</a></p>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">fit &lt;- try(auto.arima(index, trace = T), silent = TRUE)
if ('try-error' %in% class(fit)) {
  next
}
else {
  forecast &lt;- forecast(fit, h = 7, level = c(99.5))
}

# %in%
# usage: a %in% table
# a值是否包含于table中，为真输出TURE，否者输出FALSE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="警告">警告</h4>
<p>涉及警告的函数或参数众多，常用的有如下几个：</p>
<ol>
<li><strong>warn</strong>: options()的参数。设置为负数-关闭，设置为0-程序运行结束显示警告信息(default)，设置为1-出现警告信息立即显示，设置为2-警告上升为错误级别</li>
<li><strong>warnings</strong>：显示警告信息。</li>
<li><strong>suppressWarnings</strong>: 忽略警告信息</li>
</ol>
<pre class="line-numbers language-R" data-language="R"><code class="language-R">options(warn = -1) # 关闭警告提示
options('warn' = -1) # 同上
options(warn = 0) # 开启

for (w in -1:1) {
  options(warn = w); cat("\n warn =", w, "\n")
  for (i in 1:3) { cat(i, "..\n"); m &lt;- matrix(1:7, 3, 4) }
}
warnings() # 输出上述循环的warning信息

suppressWarnings(dnorm(data, params[1], params[2]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://happykelee.github.io/">Zhengting Cai</a></p>
</blockquote>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://thyzzs.top" rel="external nofollow noreferrer">thyzzs</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://thyzzs.top/2025/08/05/r-for-data-science/">https://thyzzs.top/2025/08/05/r-for-data-science/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="https://thyzzs.top" target="_blank">thyzzs</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Statistics/">
                                    <span class="chip bg-color">Statistics</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: '102OcU05Y8Tw9VQ0bl9I0Msv-gzGzoHsz',
        appKey: 's2tfPOVV1WnY0EMDuI9HKqEA',
        serverURLs: '',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'en',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2025/08/11/probability-and-statistics-in-r/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="Probability and Statistics in R">
                        
                        <span class="card-title">Probability and Statistics in R</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            聚焦于如何通过 R 语言实现概率理论与统计方法的应用，内容涵盖概率分布模拟（如二项分布、正态分布）、统计推断（假设检验、置信区间）、回归分析和蒙特卡洛方法等核心主题
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-08-11
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Course-Notes/" class="post-category">
                                    Course Notes
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Statistics/">
                        <span class="chip bg-color">Statistics</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/02/11/wen-xian-hui-bao-yu-xue-zhu-hui-yi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="文献汇报与学术会议">
                        
                        <span class="card-title">文献汇报与学术会议</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-02-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Research/" class="post-category">
                                    Research
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Literature/">
                        <span class="chip bg-color">Literature</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: 天何言哉<br />'
            + 'Author: thyzzs<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="911214248"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2026</span>
            
            <a href="/about" target="_blank">thyzzs</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;Total Words:&nbsp;<span
                        class="white-color">246.7k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2019";
                        var startMonth = "6";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'en-uk';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/thyzzs" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:thyzzs@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>





    <a href="https://twitter.com/thyzzs" class="tooltipped" target="_blank" data-tooltip="关注我的Twitter: https://twitter.com/thyzzs" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1458077873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1458077873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>





    <a href="https://www.zhihu.com/people/thyzzs" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/thyzzs" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://thyzzs.top"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
